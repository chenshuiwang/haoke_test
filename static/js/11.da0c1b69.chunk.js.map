{"version":3,"sources":["../node_modules/core-js/library/fn/object/get-prototype-of.js","../node_modules/core-js/library/modules/es6.object.get-prototype-of.js","../node_modules/babel-runtime/core-js/object/get-own-property-descriptor.js","../node_modules/core-js/library/fn/object/get-own-property-descriptor.js","../node_modules/core-js/library/modules/es6.object.get-own-property-descriptor.js","pages/citySelect/index.module.scss","pages/citySelect/index.js","../node_modules/babel-runtime/core-js/object/get-prototype-of.js","utils/request.js","../node_modules/core-js/library/modules/_object-sap.js"],"names":["require","module","exports","Object","getPrototypeOf","toObject","$getPrototypeOf","it","__esModule","$Object","key","getOwnPropertyDescriptor","toIObject","$getOwnPropertyDescriptor","f","Index","state","list","letters","currentIndex","rowRenderer","index","style","isScrolling","isVisible","v","className","indexCss","city_select_group","group_title","name","groups_content","value","map","vv","ii","city_name","onClick","cityNameClick","bind","rowHeight","length","letterClick","setState","onRowsRendered","startIndex","cityName","props","changeCity","history","go","cityList","this","push","Promise","all","axios","get","baseURL","resArr","hots","data","body","allCity","label","sort","a","b","short","forEach","firstLetter","toUpperCase","findIndex","city_select","city_select_nav","mode","icon","type","onLeftClick","city_select_content","width","window","screen","height","rowCount","scrollToIndex","scrollToAlignment","letters_content","i","letters_item","active","join","Component","connect","mapReducer","city","dispatch","clearCityAction","getPointAction","ajaxTimes","interceptors","request","use","config","loading","error","reject","response","hide","process","defaults","$export","core","fails","KEY","exec","fn","exp","S","F"],"mappings":"kFAAAA,EAAQ,KACRC,EAAOC,QAAUF,EAAQ,IAAuBG,OAAOC,gB,oBCAvD,IAAIC,EAAWL,EAAQ,IACnBM,EAAkBN,EAAQ,KAE9BA,EAAQ,GAARA,CAAyB,kBAAkB,WACzC,OAAO,SAAwBO,GAC7B,OAAOD,EAAgBD,EAASE,S,oBCNpCN,EAAOC,QAAU,CAAE,QAAWF,EAAQ,KAA0DQ,YAAY,I,oBCA5GR,EAAQ,KACR,IAAIS,EAAUT,EAAQ,IAAuBG,OAC7CF,EAAOC,QAAU,SAAkCK,EAAIG,GACrD,OAAOD,EAAQE,yBAAyBJ,EAAIG,K,oBCF9C,IAAIE,EAAYZ,EAAQ,IACpBa,EAA4Bb,EAAQ,IAAkBc,EAE1Dd,EAAQ,GAARA,CAAyB,4BAA4B,WACnD,OAAO,SAAkCO,EAAIG,GAC3C,OAAOG,EAA0BD,EAAUL,GAAKG,Q,oBCLpDT,EAAOC,QAAU,CAAC,YAAc,gCAAgC,gBAAkB,oCAAoC,oBAAsB,wCAAwC,kBAAoB,sCAAsC,YAAc,gCAAgC,eAAiB,mCAAmC,UAAY,8BAA8B,gBAAkB,oCAAoC,aAAe,iCAAiC,OAAS,6B,8NCOnea,E,4MACFC,MAAQ,CAEJC,KAAM,GAENC,QAAS,GAETC,aAAc,G,EAgDlBC,YAAc,YAMP,IALHV,EAKE,EALFA,IACAW,EAIE,EAJFA,MAGAC,GACE,EAHFC,YAGE,EAFFC,UAEE,EADFF,OAEMG,EAAI,EAAKT,MAAMC,KAAKI,GAC1B,OACI,yBAAKK,UAAWC,IAASC,kBAAmBlB,IAAKA,EAAKY,MAAOA,GACzD,yBAAKI,UAAWC,IAASE,aAAeJ,EAAEK,MAC1C,yBAAKJ,UAAWC,IAASI,gBACpBN,EAAEO,MAAMC,KAAI,SAACC,EAAIC,GAAL,OAAY,yBAAKT,UAAWC,IAASS,UAAW1B,IAAKyB,EAAIE,QAAS,EAAKC,cAAcC,KAAnB,eAA6BL,EAAGJ,OAAQI,EAAGJ,Y,EAQ1IU,UAAY,YAAgB,IAAbnB,EAAY,EAAZA,MACX,OAAO,GAA2C,GAAtC,EAAKL,MAAMC,KAAKI,GAAOW,MAAMS,Q,EAI7CC,YAAc,SAACvB,GACX,EAAKwB,SAAS,CAACxB,kB,EAInByB,eAAiB,YAAmB,IAAjBC,EAAgB,EAAhBA,WACf,EAAKF,SAAS,CAACxB,aAAc0B,K,EAIjCP,cAAgB,SAACQ,GACb,EAAKC,MAAMC,WAAWF,GACtB,EAAKC,MAAME,QAAQC,IAAI,I,mMAlFnBC,EAAW,GACXjC,EAAU,CAAC,IAAK,UAEZ4B,EAAaM,KAAKL,MAAlBD,SACRK,EAASE,KAAK,CACVvB,KAAM,2BACNE,MAAO,CAAC,CAAEF,KAAMgB,M,SAOCQ,QAAQC,IAAI,CAACC,IAAMC,IAAIC,IAAU,aAAaF,IAAMC,IAAIC,IAAU,wB,OAAjFC,E,OACAC,EAAOD,EAAO,GAAGE,KAAKC,KACtBC,EAAUJ,EAAO,GAAGE,KAAKC,KAE/BX,EAASE,KAAK,CACVvB,KAAM,2BACNE,MAAO4B,EAAK3B,KAAI,SAAAR,GAAC,MAAK,CAAEK,KAAML,EAAEuC,YAGpCD,EAAQE,MAAK,SAACC,EAAGC,GAAJ,OAAUD,EAAEE,MAAQD,EAAEC,OAAS,EAAI,KAEhDL,EAAQM,SAAQ,SAAA5C,GACZ,IAAM6C,EAAc7C,EAAE2C,MAAM,GAAGG,cACzBlD,EAAQ8B,EAASqB,WAAU,SAAAtC,GAAE,OAAIA,EAAGJ,OAASwC,MACpC,IAAXjD,GACA8B,EAASE,KAAK,CACVvB,KAAMwC,EACNtC,MAAO,CAAC,CAAEF,KAAML,EAAEuC,UAEtB9C,EAAQmC,KAAKiB,IAEbnB,EAAS9B,GAAOW,MAAMqB,KAAK,CAAEvB,KAAML,EAAEuC,WAI7CZ,KAAKT,SAAS,CACV1B,KAAMkC,EACNjC,Y,sIA6CE,IAAD,OACG+B,EAAYG,KAAKL,MAAjBE,QADH,EAE4BG,KAAKpC,MAA9BG,EAFH,EAEGA,aAAaD,EAFhB,EAEgBA,QACrB,OACI,yBAAKQ,UAAWC,IAAS8C,aAErB,yBAAK/C,UAAWC,IAAS+C,iBACrB,uBACIC,KAAK,QACLC,KAAM,uBAAMC,KAAK,SACjBC,YAAa,kBAAM7B,EAAQC,IAAI,KAHnC,6BAQJ,yBAAKxB,UAAWC,IAASoD,qBACrB,kBAAC,IAAD,CACIC,MAAOC,OAAOC,OAAOF,MACrBG,OAAQF,OAAOC,OAAOC,OAAS,GAC/BC,SAAUhC,KAAKpC,MAAMC,KAAKwB,OAC1BD,UAAWY,KAAKZ,UAChBpB,YAAagC,KAAKhC,YAClBwB,eAAgBQ,KAAKR,eACrByC,cAAelE,EACfmE,kBAAkB,UAGtB,yBAAK5D,UAAWC,IAAS4D,iBACpBrE,EAAQe,KAAI,SAACR,EAAG+D,GAAJ,OAAU,yBACnB9D,UACI,CACIC,IAAS8D,aACTtE,IAAiBqE,EAAI7D,IAAS+D,OAAS,IACzCC,KAAK,KAEXtD,QAAS,EAAKK,YAAYH,KAAK,EAAKiD,GACpC9E,IAAK8E,GAEJ/D,a,GArITmE,aA6JLC,uBAjBS,SAAC7E,GACrB,MAAO,CACH8B,SAAU9B,EAAM8E,WAAWC,KAAKjE,SAIb,SAACkE,GACxB,MAAO,CACHhD,WADG,SACSF,GAERkD,EAASC,eAETD,EAASE,YAAepD,QAKrB+C,CAA4C9E,I,mBCrK3Dd,EAAOC,QAAU,CAAE,QAAWF,EAAQ,KAA+CQ,YAAY,I,8GCI7F2F,EAAY,EAGhB3C,IAAM4C,aAAaC,QAAQC,KAAI,SAAUC,GAIrC,OAHAJ,IAEA,IAAMK,QAAQ,aAAc,GACrBD,KACN,SAAUE,GACX,OAAOnD,QAAQoD,OAAOD,MAI1BjD,IAAM4C,aAAaO,SAASL,KAAI,SAAUK,GAMtC,OAHkB,MAFpBR,GAGI,IAAMS,OAEDD,KACN,SAAUF,GACX,OAAOnD,QAAQoD,OAAOD,MAInB,IAAM/C,EAAUmD,mCACvBrD,IAAMsD,SAASpD,QAAUA,EAGVF,MAAf,G,mBChCA,IAAIuD,EAAU/G,EAAQ,IAClBgH,EAAOhH,EAAQ,IACfiH,EAAQjH,EAAQ,IACpBC,EAAOC,QAAU,SAAUgH,EAAKC,GAC9B,IAAIC,GAAMJ,EAAK7G,QAAU,IAAI+G,IAAQ/G,OAAO+G,GACxCG,EAAM,GACVA,EAAIH,GAAOC,EAAKC,GAChBL,EAAQA,EAAQO,EAAIP,EAAQQ,EAAIN,GAAM,WAAcG,EAAG,MAAQ,SAAUC","file":"static/js/11.da0c1b69.chunk.js","sourcesContent":["require('../../modules/es6.object.get-prototype-of');\nmodule.exports = require('../../modules/_core').Object.getPrototypeOf;\n","// 19.1.2.9 Object.getPrototypeOf(O)\nvar toObject = require('./_to-object');\nvar $getPrototypeOf = require('./_object-gpo');\n\nrequire('./_object-sap')('getPrototypeOf', function () {\n  return function getPrototypeOf(it) {\n    return $getPrototypeOf(toObject(it));\n  };\n});\n","module.exports = { \"default\": require(\"core-js/library/fn/object/get-own-property-descriptor\"), __esModule: true };","require('../../modules/es6.object.get-own-property-descriptor');\nvar $Object = require('../../modules/_core').Object;\nmodule.exports = function getOwnPropertyDescriptor(it, key) {\n  return $Object.getOwnPropertyDescriptor(it, key);\n};\n","// 19.1.2.6 Object.getOwnPropertyDescriptor(O, P)\nvar toIObject = require('./_to-iobject');\nvar $getOwnPropertyDescriptor = require('./_object-gopd').f;\n\nrequire('./_object-sap')('getOwnPropertyDescriptor', function () {\n  return function getOwnPropertyDescriptor(it, key) {\n    return $getOwnPropertyDescriptor(toIObject(it), key);\n  };\n});\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"city_select\":\"citySelect_city_select__3V24Y\",\"city_select_nav\":\"citySelect_city_select_nav__1sDl5\",\"city_select_content\":\"citySelect_city_select_content__2suTr\",\"city_select_group\":\"citySelect_city_select_group__3a2cD\",\"group_title\":\"citySelect_group_title__1b7Az\",\"groups_content\":\"citySelect_groups_content__196NZ\",\"city_name\":\"citySelect_city_name__34uhe\",\"letters_content\":\"citySelect_letters_content__2Asy9\",\"letters_item\":\"citySelect_letters_item__21wwB\",\"active\":\"citySelect_active__3aH-c\"};","import React, { Component } from 'react';\r\nimport { NavBar, Icon } from 'antd-mobile';\r\nimport { connect } from \"react-redux\";\r\nimport axios, { baseURL } from '../../utils/request';\r\nimport indexCss from './index.module.scss'\r\nimport { List } from 'react-virtualized';\r\nimport { getPointAction,clearCityAction } from \"../../store/actionCreator\";\r\n\r\nclass Index extends Component {\r\n    state = {\r\n        // 城市列表数据\r\n        list: [],\r\n        // 字母数组\r\n        letters: [],\r\n        // 字母列表选中的索引\r\n        currentIndex: 0\r\n    }\r\n    async componentDidMount() {\r\n        let cityList = [];\r\n        let letters = ['#', '热'];\r\n        // 获取当前城市\r\n        const { cityName } = this.props;\r\n        cityList.push({\r\n            name: '当前城市',\r\n            value: [{ name: cityName }]\r\n        })\r\n        // // 获取热门城市\r\n        // const hots = (await axios.get(baseURL + '/area/hot')).data.body;\r\n        // // 获取所有城市\r\n        // const allCity = (await axios.get(baseURL + '/area/city?level=1')).data.body;\r\n\r\n        const resArr = await Promise.all([axios.get(baseURL + '/area/hot'),axios.get(baseURL + '/area/city?level=1')])\r\n        const hots = resArr[0].data.body;\r\n        const allCity = resArr[1].data.body;\r\n        \r\n        cityList.push({\r\n            name: '热门城市',\r\n            value: hots.map(v => ({ name: v.label }))\r\n        })\r\n\r\n        allCity.sort((a, b) => a.short < b.short ? -1 : 1);\r\n        // console.log(hots.map(v => ({name:v.label})))\r\n        allCity.forEach(v => {\r\n            const firstLetter = v.short[0].toUpperCase();\r\n            const index = cityList.findIndex(vv => vv.name === firstLetter);\r\n            if (index === -1) {\r\n                cityList.push({\r\n                    name: firstLetter,\r\n                    value: [{ name: v.label }]\r\n                })\r\n                letters.push(firstLetter)\r\n            } else {\r\n                cityList[index].value.push({ name: v.label })\r\n            }\r\n\r\n        });\r\n        this.setState({\r\n            list: cityList,\r\n            letters\r\n        });\r\n\r\n    }\r\n\r\n    rowRenderer = ({\r\n        key, // Unique key within array of rows\r\n        index, // Index of row within collection\r\n        isScrolling, // The List is currently being scrolled\r\n        isVisible, // This row is visible within the List (eg it is not an overscanned row)\r\n        style, // Style object to be applied to row (to position it)\r\n    }) => {\r\n        const v = this.state.list[index]\r\n        return (\r\n            <div className={indexCss.city_select_group} key={key} style={style}>\r\n                <div className={indexCss.group_title} >{v.name}</div>\r\n                <div className={indexCss.groups_content}>\r\n                    {v.value.map((vv, ii) => <div className={indexCss.city_name} key={ii} onClick={this.cityNameClick.bind(this,vv.name)}>{vv.name}</div>)}\r\n                </div>\r\n            </div>\r\n\r\n        );\r\n    }\r\n\r\n    // 动态计算每一行的高度\r\n    rowHeight = ({ index }) => {\r\n        return 40 + this.state.list[index].value.length * 40\r\n    }\r\n\r\n    // 字母点击事件\r\n    letterClick = (currentIndex) => {\r\n        this.setState({currentIndex})\r\n    }\r\n\r\n    // 列表滚动事件\r\n    onRowsRendered = ({startIndex}) => {\r\n        this.setState({currentIndex: startIndex})\r\n    }\r\n    \r\n    // 城市名称点击事件\r\n    cityNameClick = (cityName) => {\r\n        this.props.changeCity(cityName);\r\n        this.props.history.go(-1)\r\n    }\r\n\r\n    render() {\r\n        const { history } = this.props;\r\n        const { currentIndex,letters } = this.state\r\n        return (\r\n            <div className={indexCss.city_select}>\r\n                {/* 头部导航栏 */}\r\n                <div className={indexCss.city_select_nav}>\r\n                    <NavBar\r\n                        mode=\"light\"\r\n                        icon={<Icon type=\"left\" />}\r\n                        onLeftClick={() => history.go(-1)}\r\n                    >城市选择</NavBar>\r\n                </div>\r\n\r\n                {/* 城市列表 */}\r\n                <div className={indexCss.city_select_content}>\r\n                    <List\r\n                        width={window.screen.width}\r\n                        height={window.screen.height - 45}\r\n                        rowCount={this.state.list.length}\r\n                        rowHeight={this.rowHeight}\r\n                        rowRenderer={this.rowRenderer}\r\n                        onRowsRendered={this.onRowsRendered}\r\n                        scrollToIndex={currentIndex}\r\n                        scrollToAlignment='start'\r\n                    />\r\n                    {/* 字母列表 */}\r\n                    <div className={indexCss.letters_content}>\r\n                        {letters.map((v, i) => <div\r\n                            className={\r\n                                [\r\n                                    indexCss.letters_item,\r\n                                    currentIndex === i ? indexCss.active : ''\r\n                                ].join(' ')\r\n                            }\r\n                            onClick={this.letterClick.bind(this,i)}\r\n                            key={i}\r\n                        >\r\n                            {v}</div>)}\r\n                    </div>\r\n                </div>\r\n            </div>);\r\n    }\r\n}\r\n\r\nconst mapStateToProps = (state) => {\r\n    return {\r\n        cityName: state.mapReducer.city.name\r\n    }\r\n}\r\n\r\nconst mapDispatchToProps = (dispatch) => {\r\n    return {\r\n        changeCity (cityName) {\r\n            // 清空城市\r\n            dispatch(clearCityAction())\r\n            // 改变城市\r\n            dispatch(getPointAction(cityName))\r\n        }\r\n    }\r\n}\r\n\r\nexport default connect(mapStateToProps,mapDispatchToProps)(Index);","module.exports = { \"default\": require(\"core-js/library/fn/object/get-prototype-of\"), __esModule: true };","import axios from \"axios\";\r\nimport { Toast } from 'antd-mobile';\r\n\r\n// 发送请求的个数\r\nlet ajaxTimes = 0;\r\n\r\n// 请求拦截器\r\naxios.interceptors.request.use(function (config) {\r\n    ajaxTimes++;\r\n    // 在发送请求之前显示加载中\r\n    Toast.loading('Loading...', 0)\r\n    return config;\r\n  }, function (error) {\r\n    return Promise.reject(error);\r\n  });\r\n\r\n// 添加响应拦截器\r\naxios.interceptors.response.use(function (response) {\r\n  ajaxTimes--;\r\n    // 对响应数据隐藏\r\n    if (ajaxTimes === 0) {\r\n      Toast.hide()\r\n    }\r\n    return response;\r\n  }, function (error) {\r\n    return Promise.reject(error);\r\n  });\r\n\r\n// 设置请求的基准路径\r\nexport const baseURL = process.env.REACT_APP_URL\r\naxios.defaults.baseURL = baseURL;\r\n\r\n\r\nexport default axios\r\n","// most Object methods by ES6 should accept primitives\nvar $export = require('./_export');\nvar core = require('./_core');\nvar fails = require('./_fails');\nmodule.exports = function (KEY, exec) {\n  var fn = (core.Object || {})[KEY] || Object[KEY];\n  var exp = {};\n  exp[KEY] = exec(fn);\n  $export($export.S + $export.F * fails(function () { fn(1); }), 'Object', exp);\n};\n"],"sourceRoot":""}